import{existsSync,readFileSync,writeFileSync}from"fs";import path from"path";export class DatabaseJson{constructor(){this.db={config:{},groups:{},users:{}};let s=path.join(import.meta.dirname,"files/");this.files={config:path.join(s,"config.json"),groups:path.join(s,"groups.json"),users:path.join(s,"users.json")};this.initDB()}initDB(){Object.keys(this.files).forEach(s=>{if(existsSync(this.files[s])){console.log("File %s is Ok",s);this.db[s]=JSON.parse(readFileSync(this.files[s]))}else{console.log("Creating file %s.json",s);writeFileSync(this.files[s],"{}");this.db[s]=JSON.parse(readFileSync(this.files[s]))}})}save(){Object.keys(this.files).forEach(s=>{writeFileSync(this.files[s],JSON.stringify(this.db[s]))})}addGroup(s){if(!s||!s.endsWith("@g.us"))return 0;if(this.checkGroup(s))return 2;this.db.groups[s]={mute:true,welcome:false};return 1}checkGroup(s){return!!this.db.groups?.[s]}getGroup(s){if(!s||!s.endsWith("@g.us"))return 0;return this.db.groups[s]}setGroup(s,[e,r]){if(!s||!s.endsWith("@g.us"))return 0;if(!this.checkGroup(s))return 3;this.db.groups[s][e]=r;return 1}checkUser(s){return!!this.db.users?.[s]}addUser(s){if(!s)return 0;if(this.checkUser(s))return 2;this.db.users[s]={premium:false,limit:100,warning:0,isBan:false};return 1}setUser(s,[e,r]){if(!s)return 0;if(!this.checkUser(s))return 3;this.db.users[s][e]=r;return 1}getUser(s){if(!s)return 0;return this.db.users[s]}}
